(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-c16b"],{"1mJT":function(t,e,a){"use strict";var o=a("4IPN");a.n(o).a},"4IPN":function(t,e,a){},xwR7:function(t,e,a){"use strict";a.r(e);var o={name:"OnlinePlayerListPage",filters:{moneyFilter:function(t){return t?t/100:0},getWinningMoney:function(t){return t.playersWinLoseVO?(console.log(t.playersWinLoseVO.winningMoney),t.playersWinLoseVO.winningMoney):0},getTotalWinningMoney:function(t){return t.totalPlayersWinLoseVO?t.totalPlayersWinLoseVO.winningMoney:0}},data:function(){return{timer:"",filterForm:{showId:null,gameId:0,pageNo:1,pageSize:10},games:[],list:null,listLoading:!1,listTotal:10,totalGoldEntitys:[],dialogNewOrEditVisible:!1,formData:{},controlGames:[127,151,152,128,126,142,143],dialogRules:{luckyRatio:[{required:!0,trigger:"blur",validator:function(t,e,a){0===e||e&&0!==e.length?isNaN(Number(e))?a(new Error("必须为纯数字")):a():a(new Error("必填项"))}}]},saveBtnLoading:!1}},created:function(){this.queryGames(),this.queryInterval()},beforeDestroy:function(){this.timer&&clearInterval(this.timer)},methods:{queryGames:function(){var t=this;this.$store.dispatch("ListGamesAndOnlineCount").then(function(e){t.games=e.data}),this.query(),this.totalGold()},queryInterval:function(){this.timer&&clearInterval(this.timer),this.queryGames(),this.timer=setInterval(this.queryGames,5e3)},query:function(){var t=this;this.listLoading=!0,this.$store.dispatch("ListOnlinePlayerQry",this.filterForm).then(function(e){t.list=e.data,t.listTotal=e.totalCount,t.listLoading=!1}).catch(function(){t.listLoading=!1})},totalGold:function(){var t=this;this.listLoading=!0,this.$store.dispatch("ListOnlineTotalGold",this.filterForm).then(function(e){t.totalGoldEntitys=e.data,t.listLoading=!1}).catch(function(){t.listLoading=!1})},changeBtnValue:function(t){this.filterForm.gameId=t,this.queryInterval()},changeRatio:function(t){clearInterval(this.timer),this.dialogNewOrEditVisible=!0,this.formData={userid:t.userid,room:t.room,luckyRatio:t.luckyRatio}},cancel:function(){this.dialogNewOrEditVisible=!1,this.queryInterval()},saveData:function(){var t=this;this.$refs.dialogForm.validate(function(e){e&&(127!==Math.floor(t.formData.room/100)&&t.controlGames.some(function(e){return Math.floor(t.formData.room/100)===e})&&t.list.forEach(function(e){if(e.room===t.formData.room&&0===e.luckyRatio)return t.$message({type:"error",message:"必杀只能设置一个人"}),!1}),t.saveBtnLoading=!0,t.$store.dispatch("UpdatePlayerLuckyRatio",t.formData).then(function(e){t.$message({type:"success",message:e.msg}),t.saveBtnLoading=!1,t.dialogNewOrEditVisible=!1,t.queryInterval()}).catch(function(){t.saveBtnLoading=!1}))})},handleClick:function(t){var e=this.$store.state.user.roleId,a=this.$store.state.user.menus;1!==e?this.hasPermission(a,20101)&&this.$router.push({path:"/player/playerInfo",query:{playerId:t}}):this.$router.push({path:"/player/playerInfo",query:{playerId:t}})},handleSizeChange:function(t){this.filterForm.pageSize=t,this.queryInterval()},handleCurrentChange:function(t){this.filterForm.pageNo=t,this.queryInterval()}}},n=(a("1mJT"),a("ZrdR")),l=Object(n.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-form",{ref:"filterForm",attrs:{inline:!0,model:t.filterForm,size:"mini"}},[a("el-form-item",{attrs:{label:"玩家ID"}},[a("el-input",{model:{value:t.filterForm.showId,callback:function(e){t.$set(t.filterForm,"showId",e)},expression:"filterForm.showId"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"筛选游戏"}},[a("el-button-group",[a("el-button",{attrs:{type:0===t.filterForm.gameId?"primary":""},on:{click:function(e){t.changeBtnValue(0)}}},[t._v("All")]),t._v(" "),t._l(t.games,function(e){return a("el-button",{key:e.gameid,attrs:{type:t.filterForm.gameId===e.gameid?"primary":""},on:{click:function(a){t.changeBtnValue(e.gameid)}}},[t._v("\n            "+t._s(e.gameName)+"("+t._s(e.onlineCount)+")\n          ")])})],2)],1),t._v(" "),a("el-form-item",[a("el-button",{staticClass:"btn-form",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.queryInterval}},[t._v("查询")])],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,size:"mini",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"昵称(玩家ID)"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"link-type",style:e.row.rechargeFlag>0?"color:red;":"",on:{click:function(a){t.handleClick(e.row.userid)}}},[t._v(t._s(e.row.nickName))]),t._v(" ("+t._s(e.row.showId)+")\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"房间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.roomName)+t._s(e.row.tableId)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"身上金币",align:"center"}},[a("el-table-column",{attrs:{label:"银行金币",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("moneyFilter")(e.row.gold)))]),a("br"),t._v(" "),a("span",[t._v(t._s(t._f("moneyFilter")(e.row.bankGold)))])]}}])})],1),t._v(" "),a("el-table-column",{attrs:{label:"当日充值",align:"center"}},[a("el-table-column",{attrs:{label:"总充值",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{style:e.row.todayRechargeGold>0?"color:red;":"color:green;"},[t._v(t._s(e.row.todayRechargeGold))]),a("br"),t._v(" "),a("span",{style:e.row.totalRechargeGold>0?"color:red;":"color:green;"},[t._v(t._s(e.row.totalRechargeGold))])]}}])})],1),t._v(" "),a("el-table-column",{attrs:{label:"当日提现",align:"center"}},[a("el-table-column",{attrs:{label:"总提现",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{style:e.row.todayWithdrawGold>0?"color:red;":"color:green;"},[t._v(t._s(e.row.todayWithdrawGold))]),a("br"),t._v(" "),a("span",{style:e.row.totalWithdrawGold>0?"color:red;":"color:green;"},[t._v(t._s(e.row.totalWithdrawGold))])]}}])})],1),t._v(" "),a("el-table-column",{attrs:{label:"当日输赢",align:"center"}},[a("el-table-column",{attrs:{label:"总输赢",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{style:e.row.todayWinningGold>0?"color:red;":"color:green;"},[t._v(t._s(t._f("getWinningMoney")(e.row)))]),a("br"),t._v(" "),a("span",{style:e.row.totalWinningGold>0?"color:red;":"color:green;"},[t._v(t._s(t._f("getTotalWinningMoney")(e.row)))])]}}])})],1),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"玩家幸运值"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(100*e.row.luckyRatio?100*e.row.luckyRatio:0)+" %\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"登录IP",align:"center"}},[a("el-table-column",{attrs:{label:"归属地",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.ip))]),a("br"),t._v(" "),a("span",[t._v(t._s(e.row.ipAttr))])]}}])})],1),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){t.changeRatio(e.row)}}},[t._v("调整幸运值")])]}}])})],1),t._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":t.filterForm.pageNo,"page-sizes":[10,20,30,50],"page-size":t.filterForm.pageSize,total:t.listTotal,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(e){t.$set(t.filterForm,"pageNo",e)},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:Math.random(),staticStyle:{"margin-top":"30px"},attrs:{data:t.totalGoldEntitys,size:"mini",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"合计类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.type)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"总金币"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("moneyFilter")(e.row.totalGold))+"\n      ")]}}])})],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogNewOrEditVisible,title:"调整幸运值",width:"400px"},on:{"update:visible":function(e){t.dialogNewOrEditVisible=e}}},[a("el-form",{ref:"dialogForm",staticStyle:{"margin-left":"30px"},attrs:{model:t.formData,rules:t.dialogRules,"label-position":"left","label-width":"80px"}},[t.controlGames.some(function(e){return Math.floor(t.formData.room/100)===e})?t._e():a("el-form-item",{attrs:{label:"幸运值",prop:"luckyRatio"}},[a("el-input",{model:{value:t.formData.luckyRatio,callback:function(e){t.$set(t.formData,"luckyRatio",e)},expression:"formData.luckyRatio"}})],1),t._v(" "),t.controlGames.some(function(e){return Math.floor(t.formData.room/100)===e})?a("el-form-item",{attrs:{label:"幸运值",prop:"luckyRatio"}},[a("el-radio-group",{model:{value:t.formData.luckyRatio,callback:function(e){t.$set(t.formData,"luckyRatio",e)},expression:"formData.luckyRatio"}},[a("el-radio",{attrs:{label:.98}},[t._v("正常模式")]),t._v(" "),a("el-radio",{attrs:{label:0}},[t._v("必杀模式")])],1)],1):t._e()],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{loading:t.saveBtnLoading,type:"primary"},on:{click:t.saveData}},[t._v("保存")])],1)],1)],1)},[],!1,null,"b8f1b350",null);l.options.__file="index.vue";e.default=l.exports}}]);